@model List<TopRestaurant>

@{
    ViewData["Title"] = "Dashboard | Topder";
}

<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="~/admin/vendors/feather/feather.css">
        <link rel="stylesheet" href="~/admin/vendors/mdi/css/materialdesignicons.min.css">
        <link rel="stylesheet" href="~/admin/vendors/ti-icons/css/themify-icons.css">
        <link rel="stylesheet" href="~/admin/vendors/typicons/typicons.css">
        <link rel="stylesheet" href="~/admin/vendors/simple-line-icons/css/simple-line-icons.css">
        <link rel="stylesheet" href="~/admin/vendors/css/vendor.bundle.base.css">
        <link rel="stylesheet" href="~/admin/css/vertical-layout-light/style.css">
        <style>
            a {
                all: unset;
                cursor: pointer;
            }
        </style>
    </head>
    <body>
                <div class="container-scroller">

                 <partial name="/Views/Shared/HeaderAdmin.cshtml"/>

                <partial name="/Views/Shared/LeftPageAdmin.cshtml"/>

                <!-- partial -->
                <div class="main-panel">
                    <div class="content-wrapper">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="home-tab">
                                    <div class="d-sm-flex align-items-center justify-content-between border-bottom">
                                        <ul class="nav nav-tabs" role="tablist">
                                            <li class="nav-item">
                                                <a class="nav-link active ps-0" id="home-tab" data-bs-toggle="tab" href="#overview" role="tab" aria-controls="overview" aria-selected="true">Overview</a>
                                            </li>
                                        </ul>
                                        <div>
                                            <div class="btn-wrapper">
                                                <a href="#" class="btn btn-otline-dark align-items-center"><i class="icon-share"></i> Share</a>
                                                <a href="#" class="btn btn-otline-dark"><i class="icon-printer"></i> Print</a>
                                                <a href="#" class="btn btn-primary text-white me-0"><i class="icon-download"></i> Export</a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tab-content tab-content-basic">
                                        <div class="tab-pane fade show active" id="overview" role="tabpanel" aria-labelledby="overview"> 
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <div class="statistics-details d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <h4>Total Order</h4>
                                                            <h3 class="rate-percentage badge badge-opacity-warning">@ViewBag.TotalOrder</h3>
                                                        </div>
                                                        <div>
                                                            <h4 class="">Total Customer</h4>
                                                            <h3 class="rate-percentage badge badge-opacity-success">@*@ViewBag.TotalCustomer*@471</h3>
                                                        </div>
                                                        <div>
                                                            <h4 class="">Total Restaurant</h4>
                                                            <h3 class="rate-percentage badge badge badge-danger text-danger">@ViewBag.TotalRestaurant</h3>
                                                        </div>
                                                        <div>
                                                            <h4 class="">Total Blog</h4>
                                                            <h3 class="rate-percentage badge badge-opacity-info text-info">@ViewBag.TotalBlog</h3>
                                                        </div>
                                                        <div>
                                                            <h4 class="">Total Contact</h4>
                                                            <h3 class="rate-percentage badge badge-opacity-secondary text-secondary">@ViewBag.TotalContact</h3>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div> 
                                            <div class="row">
                                                <div class="col-lg-8 d-flex flex-column">
                                                    <div class="row flex-grow">
                                                        <div class="col-12 grid-margin stretch-card">
                                                            <div class="card card-rounded">
                                                                <div class="card-body">
                                                                    <div class="d-sm-flex justify-content-between align-items-start">
                                                                        <div>
                                                                            <h4 class="card-title card-title-dash">Market Overview</h4>
                                                                            <p class="card-subtitle card-subtitle-dash">Summary of total order for year</p>
                                                                        </div>
                                                                        <div>
                                                                            <div class="dropdown">
                                                                                <button class="btn btn-secondary dropdown-toggle toggle-dark btn-lg mb-0 me-0" type="button" id="dropdownMenuButton2" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> This Year: @ViewBag.Year </button>
                                                                                
                                                                                     @if (ViewBag.t1 != 0 || ViewBag.t2 != 0 || ViewBag.t3 != 0 || 
                                                                                            ViewBag.t4 != 0 || ViewBag.t5 != 0 ||ViewBag.t6 != 0 ||
                                                                                            ViewBag.t7 != 0 ||ViewBag.t8 != 0 ||ViewBag.t9 != 0 ||
                                                                                            ViewBag.t10 != 0 ||ViewBag.t11 != 0 ||ViewBag.t12 != 0)
                                                                                        {
                                                                                            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton2">
                                                                                                <h6 class="dropdown-header">Year</h6>
                                                                                                <a class="dropdown-item" href="/admin/dashboard?service=searchTotalIncomeYear&year=@(ViewBag.Year-1)">@(ViewBag.Year-1)</a>
                                                                                                <a class="dropdown-item" href="/admin/dashboard?service=searchTotalIncomeYear&year=@(ViewBag.Year-2)">@(ViewBag.Year-2)</a>
                                                                                                <a class="dropdown-item" href="/admin/dashboard?service=searchTotalIncomeYear&year=@(ViewBag.Year-3)">@(ViewBag.Year-3)</a>
                                                                                                <a class="dropdown-item" href="/admin/dashboard?service=searchTotalIncomeYear&year=@(ViewBag.Year-4)">@(ViewBag.Year-4)</a>
                                                                                                <a class="dropdown-item" href="/admin/dashboard?service=searchTotalIncomeYear&year=@(ViewBag.Year-5)">@(ViewBag.Year-5)</a>     
                                                                                                </div>
                                                                                        }
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="d-sm-flex align-items-center mt-1 justify-content-between">
                                                                        <div class="d-sm-flex align-items-center mt-4 justify-content-between"><h2 class="me-2 fw-bold text-info">@ViewBag.TotalOrderYear</h2></div>
                                                                        <div class="me-3"><div id="marketing-overview-legend"></div></div>
                                                                    </div>
                                                                    <div class="chartjs-bar-wrapper mt-3">
                                                                         <canvas id="marketingOverview"></canvas>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-6 col-lg-6 grid-margin stretch-card">
                                                                    <div class="card card-rounded">
                                                                        <div class="card-body">
                                                                            <div class="row">
                                                                                <div class="col-lg-12">
                                                                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                                                                        <h4 class="card-title card-title-dash">Top Categories</h4>
                                                                                    </div>
                                                                                    @if(ViewBag.TopCategories != null)
                                                                                    {   
                                                                                        <canvas class="my-auto" id="doughnutChart" ></canvas>
                                                                                        @*<div id="doughnut-chart-legend" class="mt-5 text-center"></div>*@
                                                                                    }else{
                                                                                         <p>Chưa có cửa hàng để phân tích loại.</p>
                                                                                    }
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                        </div>

                                                        <div class="col-md-6 col-lg-6 grid-margin stretch-card">
                                                            <div class="card card-rounded">
                                                                <div class="card-body">
                                                                    <div class="row">
                                                                        <div class="col-lg-12">
                                                                            <div class="d-flex justify-content-between align-items-center mb-3">
                                                                                <div>
                                                                                    <h4 class="card-title card-title-dash">Top Restaurants</h4>
                                                                                </div>
                                                                            </div>
                                                                            <div class="mt-3">
                                                                        @if (Model.Count() > 0)
                                                                        {
                                                                        @foreach (var item in Model)
                                                                                {
                                                                                <div class="wrapper d-flex align-items-center justify-content-between py-2 border-bottom">
                                                                                        <div class="d-flex">
                                                                                                <img class="img-sm rounded-10" src="@item.Image" alt="profile">
                                                                                            <div class="wrapper ms-3">
                                                                                                <p class="ms-1 mb-1 fw-bold">@item.Name</p>
                                                                                                <small class="text-muted mb-0 number">@item.TotalOrder</small>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="text-muted text-small">
                                                                                            Id: @item.RestaurantId
                                                                                        </div>
                                                                                    </div>
                                                                                 }                                                                            
                                                                        }else{
                                                                            <p>Chưa có nhà hàng.</p>
                                                                        }
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>
                                                <div class="col-lg-4 d-flex flex-column">
                                                    <div class="row">
                                                        <div class="col-12 grid-margin stretch-card">
                                                            <div class="card card-rounded">
                                                                <div class="card-body">
                                                                    <div class="row">
                                                                        <div class="col-lg-12">
                                                                            <div class="d-flex justify-content-between align-items-center">
                                                                                <h4 class="card-title card-title-dash">Order Status</h4>
                                                                                <div class="add-items d-flex mb-0">
                                                                                    <!-- <input type="text" class="form-control todo-list-input" placeholder="What do you need to do today?"> -->
                                                                                    <button class="add btn btn-icons btn-rounded btn-primary todo-list-add-btn text-white me-0 pl-12p"><i class="mdi mdi-plus"></i></button>
                                                                                </div>
                                                                            </div>
                                                                            <div class="list-wrapper">
                                                                                <ul class="todo-list todo-list-rounded">
                                                                                    <li class="d-block">
                                                                                        <div class="form-check w-100">
                                                                                            <label class="form-check-label">
                                                                                                <input class="checkbox" type="checkbox"> Total of Wait: @ViewBag.Wait <i class="input-helper rounded"></i>
                                                                                            </label>
                                                                                            <div class="d-flex mt-2">
                                                                                                <a href="/admin/order/?service=displayOrderStatus&status=Wait"><div class="ps-4 text-small me-3">Click to view</div></a>
                                                                                                <div class="badge badge-opacity-secondary me-3">Wait</div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </li>

                                                                                    <li>
                                                                                        <div class="form-check w-100">
                                                                                            <label class="form-check-label">
                                                                                                <input class="checkbox" type="checkbox"> Total of Accept: @ViewBag.Accept <i class="input-helper rounded"></i>
                                                                                            </label>
                                                                                            <div class="d-flex mt-2">
                                                                                                <a href="/admin/order/?service=displayOrderStatus&status=Accept"><div class="ps-4 text-small me-3">Click to view</div></a> 
                                                                                                <div class="badge badge-opacity-info me-3">Accept</div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </li>

                                                                                    <li class="d-block">
                                                                                        <div class="form-check w-100">
                                                                                            <label class="form-check-label">
                                                                                                <input class="checkbox" type="checkbox"> Total of Process: @ViewBag.Process <i class="input-helper rounded"></i>
                                                                                            </label>
                                                                                            <div class="d-flex mt-2">
                                                                                               <a href="/admin/order/?service=displayOrderStatus&status=Process"><div class="ps-4 text-small me-3">Click to view</div></a> 
                                                                                                <div class="badge badge-opacity-warning me-3">Process</div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </li>
                                                                                    <li>
                                                                                        <div class="form-check w-100">
                                                                                            <label class="form-check-label">
                                                                                                <input class="checkbox" type="checkbox"> Total of Done: @ViewBag.Success <i class="input-helper rounded"></i>
                                                                                            </label>
                                                                                            <div class="d-flex mt-2">
                                                                                                <a href="/admin/order/?service=displayOrderStatus&status=Done"><div class="ps-4 text-small me-3">Click to view</div></a> 
                                                                                                <div class="badge badge-opacity-success me-3">Done</div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </li>
                                                                                    <li class="border-bottom-0">
                                                                                        <div class="form-check w-100">
                                                                                            <label class="form-check-label">
                                                                                                <input class="checkbox" type="checkbox"> Total of Cancel: @ViewBag.Cancel <i class="input-helper rounded"></i>
                                                                                            </label>
                                                                                            <div class="d-flex mt-2">
                                                                                               <a href="/admin/order/?service=displayOrderStatus&status=Cancel"><div class="ps-4 text-small me-3">Click to view</div></a> 
                                                                                                <div class="badge badge-opacity-danger me-3">Cancel</div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </li>
                                                                                </ul>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-12 grid-margin stretch-card">
                                                            <div class="card card-rounded">
                                                                <div class="card-body">
                                                                    <div class="row">
                                                                        <div class="col-lg-12">
                                                                            <div class="d-flex justify-content-between align-items-center mb-3">
                                                                                <div>
                                                                                    <h4 class="card-title card-title-dash">Status Order Report</h4>
                                                                                </div>
                                                                            </div>
                                                                            <div class="mt-3">
                                                                                     <canvas id="leaveReport"></canvas>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- content-wrapper ends -->
                    <!-- partial:partials/_footer.html -->
                    <footer class="footer">
                        <div class="d-sm-flex justify-content-center justify-content-sm-between">
                            <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center">Copyright © 2024 Topder. All rights reserved.</span>
                        </div>
                    </footer>
                    <!-- partial -->
                </div>
                <!-- main-panel ends -->
            </div>


        <script src="~/admin/vendors/js/vendor.bundle.base.js"></script>
        <script src="~/admin/vendors/chart.js/Chart.min.js"></script>
        <script src="~/admin/vendors/bootstrap-datepicker/bootstrap-datepicker.min.js"></script>
        <script src="~/admin/vendors/progressbar.js/progressbar.min.js"></script>

        <script src="~/admin/js/off-canvas.js"></script>
        <script src="~/admin/js/hoverable-collapse.js"></script>
        <script src="~/admin/js/template.js"></script>
        <script src="~/admin/js/settings.js"></script>
        <script src="~/admin/js/todolist.js"></script>

        <script src="~/admin/js/jquery.cookie.js" type="text/javascript"></script>
        <script src="~/admin/js/Chart.roundedBarCharts.js"></script>

    <script>

        //marketingOverview
        $(document).ready(function () {
            if ($("#marketingOverview").length) {
                var marketingOverviewChart = document.getElementById("marketingOverview").getContext('2d');
                var marketingOverviewData = {
                    labels: ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"],
                    datasets: [{
                        label: @ViewBag.Year, 
                        data: [
                            @ViewBag.t1, @ViewBag.t2, @ViewBag.t3, @ViewBag.t4, @ViewBag.t5, @ViewBag.t6,
                            @ViewBag.t7, @ViewBag.t8, @ViewBag.t9, @ViewBag.t10, @ViewBag.t11, @ViewBag.t12 
                        ],
                        backgroundColor: "#1F3BB3",
                        borderColor: [
                            '#1F3BB3',
                        ],
                        borderWidth: 0,
                        fill: true
                    }]
                };

                var marketingOverviewOptions = {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        yAxes: [{
                            gridLines: {
                                display: true,
                                drawBorder: false,
                                color: "#F0F0F0",
                                zeroLineColor: '#F0F0F0',
                            },
                            ticks: {
                                beginAtZero: true,
                                autoSkip: true,
                                maxTicksLimit: 5,
                                fontSize: 10,
                                color: "#6B778C"
                            }
                        }],
                        xAxes: [{
                            stacked: true,
                            barPercentage: 0.35,
                            gridLines: {
                                display: false,
                                drawBorder: false,
                            },
                            ticks: {
                                beginAtZero: false,
                                autoSkip: true,
                                maxTicksLimit: 12,
                                fontSize: 10,
                                color: "#6B778C"
                            }
                        }],
                    },
                    legend: false,
                    legendCallback: function (chart) {
                        var text = [];
                        text.push('<div class="chartjs-legend"><ul>');
                        for (var i = 0; i < chart.data.datasets.length; i++) {
                            console.log(chart.data.datasets[i]); // see what's inside the obj.
                            text.push('<li class="text-muted text-small">');
                            text.push('<span style="background-color:' + chart.data.datasets[i].borderColor + '">' + '</span>');
                            text.push(chart.data.datasets[i].label);
                            text.push('</li>');
                        }
                        text.push('</ul></div>');
                        return text.join("");
                    },
                    elements: {
                        line: {
                            tension: 0.4,
                        }
                    },
                    tooltips: {
                        backgroundColor: 'rgba(31, 59, 179, 1)',
                    }
                }
                var marketingOverview = new Chart(marketingOverviewChart, {
                    type: 'bar',
                    data: marketingOverviewData,
                    options: marketingOverviewOptions
                });
                document.getElementById('marketing-overview-legend').innerHTML = marketingOverview.generateLegend();
            }
        });
    </script>


    
  @* TOP CATEGORIES*@
    <script>
        $(document).ready(function () {
            if ($("#doughnutChart").length) {
                var doughnutChartCanvas = $("#doughnutChart").get(0).getContext("2d");

                            var category = [
                                @foreach(var item in ViewBag.TopCategories)
                                {
                                    @: @item.RestaurantCount,
                                }  
                            ];

                            var categoryname = [
                                @foreach(var item in ViewBag.TopCategories)
                                {
                                     @Html.Raw($"'{item.CategoryName}',")
                                }
                            ];

                var doughnutPieData = {
                    datasets: [{
                        data: category,
                        backgroundColor: [
                            "#1F3BB3",
                            "#FDD0C7",
                            "#52CDFF",
                            "#81DADA","#6A1B9A","#FFCC80","#4CAF50","#1976D2","#E57373"

                        ],
                        borderColor: [
                            "#1F3BB3",
                            "#FDD0C7",
                            "#52CDFF",
                            "#81DADA","#6A1B9A","#FFCC80","#4CAF50","#1976D2","#E57373"
                        ]
                    }],
                    labels: categoryname
                };

                var doughnutPieOptions = {
                    cutoutPercentage: 50,
                    animation: {
                        animateRotate: true,
                        animateScale: false
                    },
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false,
                            labels: {
                                color: 'rgb(255, 99, 132)'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                title: function (tooltipItem) {
                                    return doughnutPieData.labels[tooltipItem[0].dataIndex];
                                },
                                label: function (tooltipItem) {
                                    return doughnutPieData.datasets[0].data[tooltipItem.dataIndex];
                                }
                            },
                            backgroundColor: '#fff',
                            titleFont: {
                                size: 14,
                                weight: 'bold',
                                color: '#0B0F32'
                            },
                            bodyFont: {
                                size: 11,
                                color: '#737F8B'
                            },
                            displayColors: false
                        }
                    }
                };

                var doughnutChart = new Chart(doughnutChartCanvas, {
                    type: 'doughnut',
                    data: doughnutPieData,
                    options: doughnutPieOptions
                });

                document.getElementById('doughnut-chart-legend').innerHTML = doughnutChart.generateLegend();
            }
        });
    </script>

    @*Chart Order*@
    <script>
       $(document).ready(function () {
                    if ($("#leaveReport").length) {
                    var leaveReportChart = document.getElementById("leaveReport").getContext('2d');
                            var leaveReportData = {
                            labels: ["Wait", "Accept", "Process", "Done","Cancel"],
                                    datasets: [{
                                    label: 'Total',
                                             data: [@ViewBag.Wait,@ViewBag.Accept,@ViewBag.Process,@ViewBag.Done,@ViewBag.Cancel],
                                            backgroundColor: [
                                                    '#52CDFF',
                                                    '#ede190',
                                                    '#FF7F50',
                                                    '#00504B',
                                                    '#73293B'
                                                    ],
                                            borderColor: [
                                                    '#52CDFF',
                                                    '#ede190',
                                                    '#FF7F50',
                                                    '#00504B',
                                                    '#73293B'
                                            ],
                                            borderWidth: 0,
                                            fill: true, // 3: no fill

                                    }]
                            };
                            var leaveReportOptions = {
                            responsive: true,
                                    maintainAspectRatio: false,
                                    scales: {
                                    yAxes: [{
                                    gridLines: {
                                    display: true,
                                            drawBorder: false,
                                            color: "rgba(255,255,255,.05)",
                                            zeroLineColor: "rgba(255,255,255,.05)",
                                    },
                                            ticks: {
                                            beginAtZero: true,
                                                    autoSkip: true,
                                                    maxTicksLimit: 5,
                                                    fontSize: 10,
                                                    color: "#6B778C"
                                            }
                                    }],
                                            xAxes: [{
                                            barPercentage: 0.5,
                                                    gridLines: {
                                                    display: false,
                                                            drawBorder: false,
                                                    },
                                                    ticks: {
                                                    beginAtZero: false,
                                                            autoSkip: true,
                                                            maxTicksLimit: 7,
                                                            fontSize: 10,
                                                            color: "#6B778C"
                                                    }
                                            }],
                                    },
                                    legend: false,
                                    elements: {
                                    line: {
                                    tension: 0.4,
                                    }
                                    },
                                    tooltips: {
                                    backgroundColor: 'rgba(31, 59, 179, 1)',
                                    }
                            }
                    var leaveReport = new Chart(leaveReportChart, {
                    type: 'bar',
                            data: leaveReportData,
                            options: leaveReportOptions
                    });
                    }
        });
    </script>

    </body>
</html>